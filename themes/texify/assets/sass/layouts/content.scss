@use "sass:math";

@use "../vars" as *;
@use "../syntax" as *;

.content {
  .wenkai {
    font-family: "LXGW WenKai",
               "Songti SC", "STSong",
               "SimSun",
               serif;
    line-height: 1.8;
  }
  .palatino {
  font-family: "Palatino Linotype",  /* Windows */
               "Book Antiqua",       /* Windows/Mac 常见替代 */
               Palatino,             /* Mac 系统 Palatino */
               "TeX Gyre Pagella",   /* LaTeX 世界常见 Palatino clone，有的话也能用 */
               "Latin Modern Roman", /* 退回你现在的英文主字体 */
               "Times New Roman",
               serif;
  line-height: 1.7;
  }
  font-family: "Latin Modern Roman",
               "SourceHanSerifSCWeb",
               "Songti SC", "STSong",
               "SimSun",
               "Source Han Serif SC",
               "Noto Serif SC",
               serif;
  .MathJax {
    font-size: 100% !important;
    overflow-x: auto;
    overflow-y: hidden;
  }

  .katex {
    font-size: 100% !important;
    overflow-x: auto;
    overflow-y: hidden;
  }
  /* Force symmetric spacing around display math */
  :last-child {
    margin-bottom: 0;
  }

  a {
    text-decoration: none;

    &:hover {
      text-decoration: underline;
    }

    &.footnote-ref {
      text-decoration: none;

      &::before {
        content: "[";
      }
      &::after {
        content: "]";
      }
    }
  }

  blockquote {
    background-color: var(--bg_s);
    border-left: var(--fg) $border solid;
    border-radius: $radius;
    font-style: italic;
    padding: 1rem 2rem;
  }

  blockquote blockquote {
    background-color: var(--bg1);
  }

  pre {
    background-color: var(--bg_s) !important;
    border-radius: $radius;
    font-family: "Latin Modern Mono", Courier, monospace;
    position: relative;
    overflow-x: auto;
    padding: 1rem;

    code {
      padding: 0;
    }
  }

  code {
    background-color: var(--bg_s);
    border-radius: $radius;
    font-family: "Latin Modern Mono", Courier, monospace;
    padding: 0 0.2rem;
  }
  
  mark {
    background-color: var(--bg_s);
    color: var(--fg1);
    border-radius: $radius;
    padding: 0 0.2rem;
  }

  kbd {
    background-color: var(--bg_s);
    color: var(--fg1);
    border-radius: $radius;
  }

  table {
    display: block;
    overflow-x: auto;
    margin: auto;
    background-color: var(--bg);
    border-collapse: collapse;
    border: none;

    td,
    th {
      border: var(--fg4) $border solid;
      padding: 0.1rem 0.5rem;
    }

    th {
      background-color: var(--bg_s);
      font-weight: bold;
    }
  }

  ol,
  ul {
    margin-left: $margin+1rem;
  }

  .enum-i { list-style-type: lower-roman; }
  .enum-I { list-style-type: upper-roman; }
  .enum-a { list-style-type: lower-alpha; }
  .enum-A { list-style-type: upper-alpha; }
  .enum-1 { list-style-type: decimal; }

  .enum-i.surround-paren ::marker { content: "(" counter(list-item, lower-roman) ") "; }
  .enum-I.surround-paren ::marker { content: "(" counter(list-item, upper-roman) ") "; }
  .enum-a.surround-paren ::marker { content: "(" counter(list-item, lower-alpha) ") "; }
  .enum-A.surround-paren ::marker { content: "(" counter(list-item, upper-alpha) ") "; }
  .enum-1.surround-paren ::marker { content: "(" counter(list-item, decimal) ") "; }

  .enum-i.surround-bracket ::marker { content: "[" counter(list-item, lower-roman) "] "; }
  .enum-I.surround-bracket ::marker { content: "[" counter(list-item, upper-roman) "] "; }
  .enum-a.surround-bracket ::marker { content: "[" counter(list-item, lower-alpha) "] "; }
  .enum-A.surround-bracket ::marker { content: "[" counter(list-item, upper-alpha) "] "; }
  .enum-1.surround-bracket ::marker { content: "[" counter(list-item, decimal) "] "; }

  .enum-i.surround-half ::marker { content: counter(list-item, lower-roman) ") "; }
  .enum-I.surround-half ::marker { content: counter(list-item, upper-roman) ") "; }
  .enum-a.surround-half ::marker { content: counter(list-item, lower-alpha) ") "; }
  .enum-A.surround-half ::marker { content: counter(list-item, upper-alpha) ") "; }
  .enum-1.surround-half ::marker { content: counter(list-item, decimal) ") "; }

  .enum-i.surround-dot ::marker { content: counter(list-item, lower-roman) ". "; }
  .enum-I.surround-dot ::marker { content: counter(list-item, upper-roman) ". "; }
  .enum-a.surround-dot ::marker { content: counter(list-item, lower-alpha) ". "; }
  .enum-A.surround-dot ::marker { content: counter(list-item, upper-alpha) ". "; }
  .enum-1.surround-dot ::marker { content: counter(list-item, decimal) ". "; }

  .enum-i.surround-colon ::marker { content: counter(list-item, lower-roman) ": "; }
  .enum-I.surround-colon ::marker { content: counter(list-item, upper-roman) ": "; }
  .enum-a.surround-colon ::marker { content: counter(list-item, lower-alpha) ": "; }
  .enum-A.surround-colon ::marker { content: counter(list-item, upper-alpha) ": "; }
  .enum-1.surround-colon ::marker { content: counter(list-item, decimal) ": "; }

  @media (max-width: 700px){
    ol.surround-paren,
    ol.surround-bracket,
    ol.surround-half,
    ol.surround-dot,
    ol.surround-colon {
      list-style: none;
      padding-left: 0;
      margin-left: 0.2rem;
    }

    ol.surround-paren > li,
    ol.surround-bracket > li,
    ol.surround-half > li,
    ol.surround-dot > li,
    ol.surround-colon > li {
      position: relative;
      padding-left: 2.0em;
    }

    .ol-inline-marker {
      position: absolute;
      left: 0;
      width: 1.7em;
      text-align: right;
      white-space: nowrap;
    }
  }

  .bul-dash { list-style-type: disc; }
  .bul-dash ::marker { content: "- "; }
  .bul-dot ::marker { content: "· "; }
  .bul-bullet ::marker { content: "• "; }
  .bul-tri ::marker { content: "‣ "; }
  .bul-square ::marker { content: "▪ "; }
  .bul-square-open ::marker { content: "▫ "; }
  .bul-diamond ::marker { content: "◆ "; }
  .bul-circle-open ::marker { content: "◦ "; }
  .bul-diamond-open ::marker { content: "◇ "; }
  .bul-tri-solid ::marker { content: "▸ "; }
  .bul-tri-open ::marker { content: "▹ "; }
  .bul-arrow ::marker { content: "→ "; }
  .bul-arrow-bold ::marker { content: "➔ "; }
  .bul-star ::marker { content: "⋆ "; }
  .bul-asterisk ::marker { content: "∗ "; }
  .bul-odot ::marker { content: "⊙ "; }
  .bul-tri-right ::marker { content: "⊳ "; }
  .bul-square-in-square ::marker { content: "▣ "; }
  .bul-dash-short ::marker { content: "‒ "; }
  .bul-dot-mid ::marker { content: "∙ "; }
  .bul-circle-solid ::marker { content: "◉ "; }
  .bul-circle-double ::marker { content: "◎ "; }
  .bul-circle-ring ::marker { content: "∘ "; }
  .bul-circled-asterisk ::marker { content: "⊛ "; }
  .bul-star-solid ::marker { content: "✦ "; }
  .bul-star-open ::marker { content: "✶ "; }
  .bul-diamond-fancy ::marker { content: "❖ "; }
  .bul-tri-black ::marker { content: "▻ "; }
  .bul-tri-white ::marker { content: "▷ "; }
  .bul-diamond-open-alt ::marker { content: "⟡ "; }
  .bul-starburst ::marker { content: "✺ "; }
  .bul-star-circled ::marker { content: "✪ "; }
  .bul-star-open-alt ::marker { content: "✧ "; }
  .bul-diamond-target ::marker { content: "◈ "; }
  .bul-dash-en ::marker { content: "– "; }
  .bul-dash-em ::marker { content: "— "; }
  .bul-dash-bar ::marker { content: "― "; }
  .bul-hyphen-bullet ::marker { content: "⁃ "; }

  dt {
    font-weight: bold;
  }

  dd {
    margin-left: $margin;
  }
}

button.copy-button {
  background-color: var(--bg1);
  color: var(--fg1);
  position: absolute;
  top: calc((4px + $margin) / 2);
  right: calc((4px + $margin) / 2);
  opacity: 0.7;
  border: none;
  padding: 0.5rem;
  border-radius: $radius;
  cursor: pointer;
  transition: opacity 0.3s;

  &:hover {
    opacity: 1;
    background-color: var(--bg);
  }

  .octicon-check {
    color: var(--green);
  }
}

.content blockquote,
.content div,
.content h1,
.content h2,
.content h3,
.content h4,
.content h5,
.content h6,
.content p,
.content pre,
.content ol,
.content table,
.content ul,
.content dl,
.content video {
  margin-bottom: $margin;
}

.content h1,
.content h2,
.content h3,
.content h4,
.content h5,
.content h6 {
  line-height: $f * $phi + 1;
}

.content h1 {
  font-size: $f * math.pow($phi, 2);
}

.content h2 {
  font-size: $f * math.pow($phi, math.div(3, 2));
}

.content h3 {
  font-size: $f * $phi;
}

.content h4 {
  font-size: $f * math.sqrt($phi);
}

.content h5 {
  font-size: $f;
}

.content h6 {
  font-size: math.div($f, math.sqrt($phi));
}

.content img {
  max-width: 100%;
}

.content p {
  text-align: justify;
}

// .content
.content strong.chinese {
  font-weight: normal;
  text-emphasis-style: dot;
  text-emphasis-position: under;
  -webkit-text-emphasis-style: dot;
  -webkit-text-emphasis-position: under;
}

.content.numbered-subtitles {
  counter-reset: section-h2;
  h2 {
    counter-reset: section-h3;
    &:before {
      counter-increment: section-h2;
      content: counter(section-h2) " ";
    }
  }
  h3 {
    counter-reset: section-h4;
    &:before {
      counter-increment: section-h3;
      content: counter(section-h2) "." counter(section-h3) " ";
    }
  }
  h4 {
    counter-reset: section-h5;
    &:before {
      counter-increment: section-h4;
      content: counter(section-h2) "." counter(section-h3) "."
        counter(section-h4) " ";
    }
  }
  h5 {
    counter-reset: section-h6;
    &:before {
      counter-increment: section-h5;
      content: counter(section-h2) "." counter(section-h3) "."
        counter(section-h4) "." counter(section-h5) " ";
    }
  }
  h6 {
    &:before {
      counter-increment: section-h6;
      content: counter(section-h2) "." counter(section-h3) "."
        counter(section-h4) "." counter(section-h5) "." counter(section-h6) " ";
    }
  }
}
.toc.numbered-subtitles {
  counter-reset: ul-h2;
  li {
    counter-reset: ul-h3;
    &:before {
      counter-increment: ul-h2;
      content: counter(ul-h2) " ";
    }
    li {
      counter-reset: ul-h4;
      &:before {
        counter-increment: ul-h3;
        content: counter(ul-h2) "." counter(ul-h3) " ";
      }
      li {
        counter-reset: ul-h5;
        &:before {
          counter-increment: ul-h4;
          content: counter(ul-h2) "." counter(ul-h3) "." counter(ul-h4) " ";
        }
        li {
          counter-reset: ul-h6;
          &:before {
            counter-increment: ul-h5;
            content: counter(ul-h2) "." counter(ul-h3) "." counter(ul-h4) "."
              counter(ul-h5) " ";
          }
          li {
            &:before {
              counter-increment: ul-h6;
              content: counter(ul-h2) "." counter(ul-h3) "." counter(ul-h4) "."
                counter(ul-h5) "." counter(ul-h6) " ";
            }
          }
        }
      }
    }
  }
}


.yh-pullquote{
  float: right;
  width: var(--yh-pullquote-w, 14rem);
  margin: 0.2rem 0 0.25rem 0.75rem; /* top right bottom left */
  padding: 0.6rem 0.8rem;
  border-left: 3px solid rgba(0,0,0,0.12);
  background: rgba(0,0,0,0.03);
  border-radius: 0.5rem;
}

.yh-pullquote-text{
  font-style: italic;
  line-height: 1.45;
}

.yh-pullquote-attrib{
  margin-top: 0.4rem;
  text-align: right;     /* right aligned */
  font-style: normal;    /* normal attribution */
  opacity: 0.85;
}

/* --- Pullquote: dark mode contrast fix  */
body.darkmode .yh-pullquote{
  border-left: 3px solid rgba(251,241,199,0.22);   /* #fbf1c7 tint */
  background: rgba(251,241,199,0.06);
}

body.darkmode .yh-pullquote-attrib{
  opacity: 0.9;  /* slightly clearer in dark */
}

body.darkmode .yh-pullquote{
  background: rgba(251,241,199,0.09);
  border-left: 3px solid rgba(251,241,199,0.28);
}

/* Mobile: don’t squeeze the text; drop quote to normal flow */
@media (max-width: 700px){
  .yh-pullquote{
    float: none;
    width: auto;
    margin: 0.75rem 0;
  }
}


/* force symmetric space around KaTeX display math */
span.katex-display {
  display: block !important;
  margin-top: 0.8rem !important;
  margin-bottom: 0.7rem !important;
}
